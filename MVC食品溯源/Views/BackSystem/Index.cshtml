
@{
	Layout = null;
}

<!DOCTYPE html>

<html>
<head>
	<meta name="viewport" content="width=device-width" />
	<title>Index</title>
	<link href="~/Scripts/jquery-easyui-1.4.4/themes/bootstrap/easyui.css" rel="stylesheet" />
	<script src="~/Scripts/jquery-easyui-1.4.4/jquery.min.js"></script>
	<script src="~/Scripts/jquery-easyui-1.4.4/jquery.easyui.min.js"></script>
	<script src="~/Scripts/jquery-easyui-1.4.4/locale/easyui-lang-zh_CN.js"></script>
	<link href="~/Content/themes/icon.css" rel="stylesheet" />
	<link href="~/Scripts/jquery-easyui-1.4.4/themes/icon.css" rel="stylesheet" />
	<script src="~/Content/js/common.js"></script>
	<link href="~/Content/themes/table.css" rel="stylesheet" />
	<link href="~/Content/themes/icon.css" rel="stylesheet" />
	@*<link rel="shortcut icon" type="image/ico" href="~/Content/themes/icon/user_home.png" />*@

	<style>
		body {
			font-family: 'Microsoft YaHei';
		}
	</style>
	<script>
		//增加
		function add() {
			//alert('Open the Add Window')
			$("<div/>").dialog({
				id: "addAnimal_id",
				href: "/AnimalManagement/AddAnimal",
				title: "添加牲畜信息",
				width: 300,
				height: 200,
				modal: true,
				buttons: [{
					id: 'certain',
					text: '添 加',
					handler: function () {
						var animal_type = $("#animal_type").val();
						var feed_type = $("#feed_type").val();
						$.ajax({
							url: "/AnimalManagement/AddOneAnimal",
							data: { 'AnimalType': animal_type, 'FeedType': feed_type },
							type: "POST",
							dataType: "Json",
							success: function (data) {
								alert(data);
								$("#addAnimal_id").dialog("destroy");
								$("#this_table").datagrid("reload").datagrid("clearSelections").datagrid("clearChecked");
							}
						})
					}
				}, {
					text: '取消',
					handler: function () {
						$("addAnimal_id").dialog("destroy");
					}
				}],
				onLoad: function () {
					// do nothing
				},
				onClose: function () {
					$("#addAnimal_id").dialog("destroy");
				}
			})
		}

		//编辑
		function edit() {


		}

		//删除行
		function deleteRow() {
			var rows = $("#this_table").datagrid("getChecked");
			if (rows.length < 1)
			{
				$.messager.confirm("提示", "请先选中要删除的列");
				return;
			}
			$.messager.confirm("提示", "确定删除此列？", function (r) {
				if (r) {
					// 参数r是提示框的按钮（确定-> true 取消->false）
					//alert(r + "***");
					var AnimalID = "";
					$.each(rows, function (i, row) {
						AnimalID = row.AnimalID + ",";
					});
					AnimalID = AnimalID.substring(0, AnimalID.length - 1);
					//alert(AnimalID+" "+typeof(AnimalID));
					$.ajax({
						url: "/AnimalManagement/DeleteAnimalById",
						data: { 'ids': AnimalID },
						type: "POST",
						dataType: "Json",
						success: function (data) {
							alert(data);
							$("#this_table").datagrid("reload").datagrid("clearSelections").datagrid("clearChecked");
						}
					})
				}
			});
		}

		//添加选项卡
		function addTab(subtitle, url, icon) {
			var strHtml = '<iframe id="frmWorkArea" width="99.5%" height="99%" style="padding:1px;" frameborder="0" scrolling="yes" src="' + url + '"></iframe>';
			if (!$('#tabs').tabs('exists', subtitle)) {
				$('#tabs').tabs('add', {
					title: subtitle,
					content: strHtml,
					iconCls: icon,
					closable: true,
					loadingMessage: '正在加载中......'
				});
			} else {
				$('#tabs').tabs('select', subtitle);
			}
		}

		function openTabByName(PageName, TabName) {
			addTab(TabName, PageName, null)
		}

		//刷新标签页
		function refreshTab() {
			var index = $('#tabs').tabs('getTabIndex', $('#tabs').tabs('getSelected'));
			if (index != -1) {
				var tab = $('#tabs').tabs('getTab', index);
				$('#tabs').tabs('update', {
					tab: tab,
					options: {
						selected: true
					}
				});
			}
		}

		//关闭所有标签
		function closeTab() {

		}
	</script>
</head>
<body>
	<div class="easyui-layout" style="width:100%;height:650px;">
		<div data-options="region:'north'" style="height:100px">
			食品溯源后台管理
		</div>
		<div data-options="region:'south',split:true" style="height:50px;"></div>
		<div data-options="region:'west',split:true" title="系统设置" style="width:180px;height:100%">
			<ul class="easyui-tree">
				<li>
					<span>厂商管理</span>
					<ul>
						<li><a onclick='openTabByName("","")'>厂商认证</a></li>
						<li><a onclick='openTabByName("/Company/FarmPage","养殖场")'>养殖场管理</a></li>
						<li><a onclick='openTabByName("/Company/ButchFactoryPage","屠宰场")'>屠宰场管理</a></li>
						<li><a onclick='openTabByName("/Company/ManuFactoryPage","加工厂")'>加工厂管理</a></li>
						<li><a onclick='openTabByName("/Company/MarketPage","零售点")'>零售点管理</a></li>
					</ul>
				</li>
				<li>
					<span>菜单管理</span>
					<ul>
						<li>菜单信息</li>
					</ul>
				</li>
				<li>
					<span>权限管理</span>
					<ul>
						<li><a onclick='openTabByName("/Role/RoleIndex","角色")'>角色管理</a></li>
						<li><a onclick='openTabByName("/User/UserIndex","用户")'>用户管理</a></li>
					</ul>
				</li>
			</ul>
		</div>
		<div data-options="region:'center'">
			<div id="tabs" class="easyui-tabs" fit="true" border="false" ,data-options="
                    tools:[
                    {iconCls : 'icon-arrow_refresh',text:'刷新',handler:refreshTab},
                    {iconCls : 'icon-delete3',text:'关闭全部',handler:closeTab}
                    ]">
				<div id="home" title="主页" data-options="iconCls:'icon-house',closable:false" style="padding:10px">
					欢迎来到后台管理界面
				</div>
			</div>
		</div>
	</div>
</body>
</html>
